<!DOCTYPE html>
<html lang="en">
<head>
<!-- Oct 07, 2022 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NixOS overlay notes</title>
<meta name="author" content="Vincent Demeester" />
<meta name="keywords" content="article" />
<meta name="generator" content="Org Mode" />
<link rel='icon' type='image/x-icon' href='/images/favicon.ico'/>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<link rel='stylesheet' href='/css/new.css' type='text/css'/>
<link rel='stylesheet' href='/css/syntax.css' type='text/css'/>
<link href='/index.xml' rel='alternate' type='application/rss+xml' title='Vincent Demeester' />
</head>
<body>
<main id="content" class="content">
<header>
<h1 class="title">NixOS overlay notes</h1>
</header><p>
<a href="https://nixos.org">NixOS</a> has a concept of <code>overlays</code> since a while (<a href="https://nixos.org/nix-dev/2016-December/022386.html">around 2016</a>). The
official manual has a chapter on it : <a href="https://nixos.org/nixpkgs/manual/#chap-overlays">Overlays</a>.
</p>

<blockquote>
<p>
Overlays are used to add layers in the fix-point used by Nixpkgs to
compose the set of all packages.
</p>
</blockquote>

<p>
There is two distinct element to overlays:
</p>

<ul class="org-ul">
<li>How to define overlays ?</li>
<li>Where <code>nix</code> (and NixOS) looks for it ?</li>
</ul>

<section id="outline-container-h:56de4f99-53be-49fd-b969-a419d8e9273f" class="outline-2">
<h2 id="h:56de4f99-53be-49fd-b969-a419d8e9273f">Define an overlay</h2>
<div class="outline-text-2" id="text-h:56de4f99-53be-49fd-b969-a419d8e9273f">
<p>
According to the documentation, « Overlays are Nix functions which
accept two arguments, conventionally called self and super, and return
a set of packages ». The documentation gives an example :
</p>

<div class="org-src-container">
<pre class="src src-nix">self: super:

{
  <span class="org-nix-attribute">boost</span> = super.boost.override {
    <span class="org-nix-attribute">python</span> = self.python3;
  };
  <span class="org-nix-attribute">rr</span> = super.callPackage <span class="org-nix-constant">./pkgs/rr</span> {
    <span class="org-nix-attribute">stdenv</span> = self.stdenv_32bit;
  };
}
</pre>
</div>

<p>
I used to have a personal channels on github : <a href="https://github.com/vdemeester/sbrpkgs/">sbrpkgs</a>. Let&rsquo;s convert
this repository to an overlay by updating the <code>default.nix</code> file.
</p>
</div>
</section>
</main>
<footer id="postamble" class="status">
<footer>
     <small><a href="/" rel="history">Index</a> • <a href="/sitemap.html">Sitemap</a> • <a href="https://dl.sbr.pm/">Files</a></small><br/>
     <small class='questions'>Questions, comments ? Please use my <a href="https://lists.sr.ht/~vdemeester/public-inbox">public inbox</a> by sending a plain-text email to <a href="mailto:~vdemeester/public-inbox@lists.sr.ht">~vdemeester/public-inbox@lists.sr.ht</a>.</small><br/>
     <small class='copyright'>
      Content and design by Vincent Demeester
      (<a rel='licence' href='http://creativecommons.org/licenses/by-nc-sa/3.0/'>Some rights reserved</a>)
    </small><br />
</footer>
</footer>
</body>
</html>
